\documentclass[a4paper,12pt,fleqn]{article}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{graphicx}


\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{algorithm,algorithmic}
\usepackage{subfigure}
\usepackage{euscript}
\usepackage{verbatim}
\usepackage{amssymb}
%\usepackage{cite}
\usepackage{color}
\usepackage{cancel}

\textwidth 18cm
\textheight23cm
\topmargin-2.0cm
\oddsidemargin-0.5cm
\evensidemargin-0.5cm

\newcommand{\QxN}{Q_{x_N}}
\newcommand{\Qx}{Q_{x}}
\newcommand{\Qu}{Q_{u}}
\newcommand{\Qdu}{Q_{\Delta u}}

\newcommand{\n}{\xi}
\newcommand{\greedy}{\text{greedy}}
\newcommand{\DP}[1]{\textcolor{red}{#1}}
\newcommand{\MPC}{\mathrm{MPC}}
\newcommand{\Np}{N_p}

\begin{document}

 \title{MPC Python}
\author{Marco Forgione}

\maketitle

\section*{Abstract}

\section{MPC Problem}
The MPC problem to be solved is:
\begin{subequations}
\label{eq:MPC}
\begin{align}
  &\arg \min_{\{u\}_0^{\Np-1}, \{x\}_0^{\Np}} \big(x_N - x_{ref}\big)^\top \QxN \big(x_N - x_{ref}\big) + \nonumber \\  
  &\sum_{k=0}^{\Np-1} \big(x_k - x_{ref}\big)^\top \Qx\big(x_k - x_{ref}\big) + \big(u_k - u_{ref}\big)^\top \Qu \big(u_k - u_{ref}\big)  +  
  \Delta u_k^\top \Qdu \Delta u_k \\ \nonumber
  &\text{subject to} \nonumber\\
  &x_{k+1} = Ax_k + B u_k\\ 
  &u_{min} \leq u_k \leq u_{max}\\
  &x_{min} \leq x_k \leq x_{max}\\
  &\Delta u_{min} \leq \Delta u_k \leq \Delta u_{min}\\
  &x_0 = \bar x
\end{align}
\end{subequations}
The QP solver expets a problem with form: 
\begin{subequations}
\label{eq:QP}
\begin{align}
 &\min \frac{1}{2} x^\top P x +  q^\top x \\
 &\text{subject to} \nonumber \\
 &l \leq Ax \leq u
\end{align}
\end{subequations}
The difficulty is to write the MPC optimization problem \eqref{eq:MPC} in form
\eqref{eq:QP} to use the standard QP solver.

\end{document} 

